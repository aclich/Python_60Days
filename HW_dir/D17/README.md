# Cupoy-Course-D17
[課程網址](https://www.cupoy.com/marathon-mission/00000174C4BC1B93000000016375706F795F70726572656C656173654355/00000176E0F9E0F50000001A6375706F795F72656C656173654349/)  
Cupoy Python資料科學 課程作業 D17 pandas 效能調校</br>

作業目標:  
 1. 了解效能優化方法

作業重點:  
1. 優化有很多面相可以切入，目前可以先以投影片方法為主</br>
 

題目 : 
1. 在速度較慢的時候，可以先從哪邊開始檢查?</br>
>Ans:
>速度較慢時，可從三個節點來做排查
>1. 讀取的資料檔案型態:
>    從不同格式的檔案讀取資料所花的時間會不相同，實際測試讀取的時間為pkl < hdf < csv < xlsx，若資料數量非常龐大，儲存的格式又是屬於較慢的格式，可以試著存成其他速度較快的格式。
>2. 使用到的函數:
>在對資料進行運算時(agg, transform)，盡量使用python內建的函式，會比自行編輯的函式快很多(也可使用numpy 代替特殊的運算)
>3. 使用向量化的函式:
>在進行篩選時，可用isin 向量化的函式，幫助提升篩選資料的速度。

2.   資料過大時應採取什麼方式讓記憶體占用量下降?</br>
>Ans:
>資料過大時，可以將資料型態做改變，像是int64,若紀錄的值只有正數，且最大最小值不需要用到那麼多位元，則可以轉為unsign、位元數較少的 uint16； 浮點數的部分若不要求很高的精度，也可以減少float的bitcount (float64 -> float32)， 來幫助減少資料大小。


<!--```py
index = pd.date_range("1/1/2019", periods=20, freq='D')
series = pd.Series(range(20), index=index)
```

1. 將所有轉為周資料  
2. 將周資料的值取平均  

```py
import numpy as np
import pandas as pd
index = pd.date_range('1/1/2019', periods=20, freq='D')
series = pd.Series(range(20), index=index)
series
```

```
output:
  2019-01-01     0
  2019-01-02     1
  2019-01-03     2
  2019-01-04     3
  2019-01-05     4
  2019-01-06     5
  2019-01-07     6
  2019-01-08     7
  2019-01-09     8
  2019-01-10     9
  2019-01-11    10
  2019-01-12    11
  2019-01-13    12
  2019-01-14    13
  2019-01-15    14
  2019-01-16    15
  2019-01-17    16
  2019-01-18    17
  2019-01-19    18
  2019-01-20    19
  Freq: D, dtype: int64  
```

```py
#1. 將所有轉為周資料
series.to_period(freq="W").resample(rule='W').sum()
```
```
output:
  2018-12-31/2019-01-06     15
  2019-01-07/2019-01-13     63
  2019-01-14/2019-01-20    112
  Freq: W-SUN, dtype: int64
```

```py
#2. 將周資料的值取平均
series.to_period(freq='W').resample(rule='W').mean()
```

```
output: 
  2018-12-31/2019-01-06     2.5
  2019-01-07/2019-01-13     9.0
  2019-01-14/2019-01-20    16.0
  Freq: W-SUN, dtype: float64
```